<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>threadly API documentation</title>
    <meta name="description" content="threadly a simple threadpool and scheduler for python." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#threadly.futureJob">futureJob</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#threadly.Clock">Clock</a></span>
        
          
  <ul>
    <li class="mono"><a href="#threadly.Clock.__init__">__init__</a></li>
    <li class="mono"><a href="#threadly.Clock.accurate_time">accurate_time</a></li>
    <li class="mono"><a href="#threadly.Clock.accurate_time_millis">accurate_time_millis</a></li>
    <li class="mono"><a href="#threadly.Clock.last_known_time">last_known_time</a></li>
    <li class="mono"><a href="#threadly.Clock.last_known_time_millis">last_known_time_millis</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#threadly.Executor">Executor</a></span>
        
          
  <ul>
    <li class="mono"><a href="#threadly.Executor.__init__">__init__</a></li>
    <li class="mono"><a href="#threadly.Executor.execute">execute</a></li>
    <li class="mono"><a href="#threadly.Executor.get_poolsize">get_poolsize</a></li>
    <li class="mono"><a href="#threadly.Executor.get_queue_size">get_queue_size</a></li>
    <li class="mono"><a href="#threadly.Executor.remove">remove</a></li>
    <li class="mono"><a href="#threadly.Executor.schedule">schedule</a></li>
    <li class="mono"><a href="#threadly.Executor.schedule_with_future">schedule_with_future</a></li>
    <li class="mono"><a href="#threadly.Executor.shutdown">shutdown</a></li>
    <li class="mono"><a href="#threadly.Executor.shutdown_now">shutdown_now</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#threadly.KeyRunner">KeyRunner</a></span>
        
          
  <ul>
    <li class="mono"><a href="#threadly.KeyRunner.__init__">__init__</a></li>
    <li class="mono"><a href="#threadly.KeyRunner.add">add</a></li>
    <li class="mono"><a href="#threadly.KeyRunner.run_all">run_all</a></li>
    <li class="mono"><a href="#threadly.KeyRunner.run_next">run_next</a></li>
    <li class="mono"><a href="#threadly.KeyRunner.size">size</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#threadly.ListenableFuture">ListenableFuture</a></span>
        
          
  <ul>
    <li class="mono"><a href="#threadly.ListenableFuture.__init__">__init__</a></li>
    <li class="mono"><a href="#threadly.ListenableFuture.addCallable">addCallable</a></li>
    <li class="mono"><a href="#threadly.ListenableFuture.addListener">addListener</a></li>
    <li class="mono"><a href="#threadly.ListenableFuture.get">get</a></li>
    <li class="mono"><a href="#threadly.ListenableFuture.setter">setter</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#threadly.Scheduler">Scheduler</a></span>
        
          
  <ul>
    <li class="mono"><a href="#threadly.Scheduler.__init__">__init__</a></li>
    <li class="mono"><a href="#threadly.Scheduler.execute">execute</a></li>
    <li class="mono"><a href="#threadly.Scheduler.get_poolsize">get_poolsize</a></li>
    <li class="mono"><a href="#threadly.Scheduler.get_queue_size">get_queue_size</a></li>
    <li class="mono"><a href="#threadly.Scheduler.remove">remove</a></li>
    <li class="mono"><a href="#threadly.Scheduler.schedule">schedule</a></li>
    <li class="mono"><a href="#threadly.Scheduler.schedule_with_future">schedule_with_future</a></li>
    <li class="mono"><a href="#threadly.Scheduler.shutdown">shutdown</a></li>
    <li class="mono"><a href="#threadly.Scheduler.shutdown_now">shutdown_now</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#threadly.Singleton">Singleton</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#threadly.SortedLockingList">SortedLockingList</a></span>
        
          
  <ul>
    <li class="mono"><a href="#threadly.SortedLockingList.__init__">__init__</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.add">add</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.clear">clear</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.lock">lock</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.peek">peek</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.pop">pop</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.remove">remove</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.safeIterator">safeIterator</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.size">size</a></li>
    <li class="mono"><a href="#threadly.SortedLockingList.unlock">unlock</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">threadly</span> module</h1>
  <p>threadly a simple threadpool and scheduler for python.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly', this);">Show source &equiv;</a></p>
  <div id="source-threadly" class="source">
    <div class="codehilite"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">threadly a simple threadpool and scheduler for python.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">Queue</span>
<span class="kn">from</span> <span class="nn">Queue</span> <span class="kn">import</span> <span class="n">Empty</span> <span class="k">as</span> <span class="n">EmptyException</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>



<span class="k">class</span> <span class="nc">Scheduler</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Main Scheduler Object.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poolsize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct an Scheduler instance with the set thread pool size.</span>
<span class="sd">    </span>
<span class="sd">    `poolsize` positive integer for the number of threads you want in this pool .</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;root.threadly&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__clock</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__in_shutdown</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span> <span class="o">=</span> <span class="n">SortedLockingList</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__in_delay</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delay_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span><span class="p">):</span>
      <span class="n">tmp_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__thread_pool</span><span class="p">)</span>
      <span class="n">tmp_thread</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Executor-Pool-Thread-</span><span class="si">%d</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">tmp_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="n">tmp_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_thread</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_poolsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of threads used in this Pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_queue_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of items currently awaiting Execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute a given task as soon as possible.</span>
<span class="sd">    </span>
<span class="sd">    `task` is a callable to be called on the Scheduler.</span>

<span class="sd">    `args` are the arguments to pass to the callable when called.</span>

<span class="sd">    `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">schedule_with_future</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a `ListenableFuture` for this task.  Once the task is completed the future will also be completed. </span>
<span class="sd">    This works pretty much exactly like `schedule` except you can not make a task recurring.</span>
<span class="sd">    </span>
<span class="sd">    `task` is a callable to be called on the Scheduler.</span>

<span class="sd">    `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>

<span class="sd">    `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>

<span class="sd">    `args` are the arguments to pass to the callable when called.</span>

<span class="sd">    `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job</span><span class="o">=</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
    <span class="n">future</span> <span class="o">=</span> <span class="n">ListenableFuture</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">futureJob</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">job</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">future</span>

  <span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This schedules a task to be executed.  It can be delayed, and set to a key.  It can also be marked</span>
<span class="sd">    as recurring. </span>
<span class="sd">    </span>
<span class="sd">    `task` is a callable to be called on the Scheduler.</span>

<span class="sd">    `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>

<span class="sd">    `recurring` set this to True if this should be a recurring.  You should be careful that delay is &gt; 0 when setting this to True</span>

<span class="sd">    `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>

<span class="sd">    `args` are the arguments to pass to the callable when called.</span>

<span class="sd">    `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">s_task</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__clock</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="n">delay</span>
      <span class="n">send</span> <span class="o">=</span> <span class="bp">False</span>
      <span class="k">if</span> <span class="n">delay</span><span class="o">/</span><span class="mf">1000.0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">():</span>
        <span class="n">send</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">s_task</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">recurring</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">send</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__empty</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">:</span>
          <span class="n">tmp</span> <span class="o">=</span> <span class="n">KeyRunner</span><span class="p">()</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="n">run_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="ow">and</span> <span class="n">run_key</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

          <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">True</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">run_key</span><span class="o">.</span><span class="n">run_all</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove a scheduled task from the queue.  This is a best effort remove, the task could still possibly run.  This is most useful to cancel recurring tasks.</span>
<span class="sd">    If there is more then one task with this callable scheduled only the first one is removed.</span>

<span class="sd">    `task` callable task to remove from the scheduled tasks list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">tasks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">safeIterator</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">task</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">break</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
      <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shuts down the threadpool.  Any task currently on the queue will be ran, but all Scheduled tasks </span>
<span class="sd">    will removed and no more tasks can be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">shutdown_now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shuts down the threadpool.  Any task currently being executed will still complete, </span>
<span class="sd">    but the queue will be emptied out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__internal_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">tmp_thread</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="p">:</span>
      <span class="k">while</span> <span class="n">tmp_thread</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">tmp_thread</span><span class="o">.</span><span class="n">isAlive</span><span class="p">()</span> <span class="ow">and</span> <span class="n">threading</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">tmp_thread</span> <span class="o">!=</span> <span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__empty</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>

  <span class="k">def</span> <span class="nf">__empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">pass</span>

  <span class="k">def</span> <span class="nf">__get_next_wait_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">tmp</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">task</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__clock</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">task</span><span class="o">/</span><span class="mf">1000.0</span><span class="p">)</span><span class="o">-.</span><span class="mo">0005</span>

  <span class="k">def</span> <span class="nf">__check_delay_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">dl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">dl</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">to</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">run_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">run_task</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="n">run_task</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="n">run_task</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">run_task</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
          <span class="c">#run_task[3] is recurring, if so we add again as a scheduled event</span>
          <span class="k">if</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__in_shutdown</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">run_task</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
          <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
      <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">dl</span>


  <span class="k">def</span> <span class="nf">__thread_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">__running</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">runner</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">to</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_delay_queue</span><span class="p">():</span>
          <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">to</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">to</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">runner</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">to</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">runner</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">runner</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">runner</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">runner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">exp</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">except</span> <span class="n">EmptyException</span> <span class="k">as</span> <span class="n">exp</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exp</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Exception while Executing: </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">exp</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">SortedLockingList</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is a sortedList implementation for multiThreads.  One main goal is to make adds as cheap as possible.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    clears out the list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns `True` if you get the lock `False` if you dont.</span>

<span class="sd">    Non-Blocking lock request, returns True if you get the lock false if you dont.  This is the main</span>
<span class="sd">    lock for the list once acquired you must release before any other thread can access the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">unlock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Releases the lists lock.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns and `int` of the current size of the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the first entry in the list, this does not remove the entry from the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">tmp</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tmp</span>

  <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns either the first entry from the list or the spesified entry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tmp</span>
  
  <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an entry to the list.</span>

<span class="sd">    `item` entry to add to the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">__combine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span>
          <span class="n">lmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
          <span class="n">ch</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="mi">2</span>
          <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">[</span><span class="n">ch</span><span class="p">]:</span>
              <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;ERROR:&quot;</span>
                <span class="k">return</span>
              <span class="k">else</span><span class="p">:</span>
                <span class="n">lmax</span> <span class="o">=</span> <span class="n">ch</span><span class="o">-</span><span class="mi">1</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">ch</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="n">l</span><span class="p">[</span><span class="n">ch</span><span class="p">]:</span>
              <span class="k">if</span> <span class="n">ch</span> <span class="o">&gt;=</span> <span class="n">lmax</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">break</span>
              <span class="k">else</span><span class="p">:</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">lmax</span><span class="o">-</span><span class="n">ch</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">ch</span><span class="o">+</span><span class="p">((</span><span class="n">diff</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">l</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
              <span class="k">break</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes an item from the list.</span>
<span class="sd">  </span>
<span class="sd">    `item` item to remove from the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="k">pass</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">safeIterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a non-Blocking safe iterator for the list.  It is essentially just a copy of the sorted lists</span>
<span class="sd">    entries at the time it was called. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="n">local</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">local</span><span class="p">:</span>
      <span class="k">yield</span> <span class="n">i</span>


<span class="k">class</span> <span class="nc">Executor</span><span class="p">(</span><span class="n">Scheduler</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A class for backwards compatibility, Scheduler should be used instead now.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">pass</span>


<span class="k">class</span> <span class="nc">KeyRunner</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A class to wrap keys objects for the executer.</span>
<span class="sd">  Items can be added to the KeyRunner while its running.  </span>
<span class="sd">  This is used to keep all tasks for a given key in one thread.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">False</span>

  <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a task to this runner set.</span>

<span class="sd">    `task` adds callable task to the current keyrunner set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">run_next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the next item for this key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="n">runner</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">runner</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">runner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

  <span class="k">def</span> <span class="nf">run_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run all items in this keyRunner.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">run_next</span><span class="p">()</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">False</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
          <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">futureJob</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">job</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is a simple helper function used to wrap a task on the Scheduler in a future.  Once</span>
<span class="sd">  the job runs the future will complete. </span>
<span class="sd">  </span>
<span class="sd">  `future` The future that will be completed once the job finishes.</span>
<span class="sd">  `job` The job to run before completing the future.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">job</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">job</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">job</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">future</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;Error running futureJob:&quot;</span><span class="p">,</span> <span class="n">e</span>
    <span class="n">future</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ListenableFuture</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This class i used to make a Future that can have listeners and callbacks added to it.</span>
<span class="sd">  Once setter(object) is called all listeners/callbacks are also called.  Callbacks will </span>
<span class="sd">  be given the set object, and .get() will return said object.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  
  <span class="k">def</span> <span class="nf">addListener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listener</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a listener function to this ListenableFuture.  Once set is called on this future</span>
<span class="sd">    all listeners will be ran.  Arguments for the listener can be given if needed.</span>
<span class="sd">    </span>
<span class="sd">    `listener` a callable that will be called when the future is completed</span>
<span class="sd">    `args` tuple arguments that will be passed to the listener when called.</span>
<span class="sd">    `kwargs` dict keyword arguments to be passed to the passed listener when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">listener</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">listener</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">addCallable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cable</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a callable function to this ListenableFuture.  Once set is called on this future</span>
<span class="sd">    all callables will be ran.  This works the same as the listener except the set object is passed </span>
<span class="sd">    as the first argument when the callable is called. Arguments for the listener can be given if needed.</span>
<span class="sd">    </span>
<span class="sd">    `cable` a callable that will be called when the future is completed, it must have at least 1 argument.</span>
<span class="sd">    `args` tuple arguments that will be passed to the listener when called.</span>
<span class="sd">    `kwargs` dict keyword arguments to be passed to the passed listener when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cable</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">cable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a blocking call that will return the set object once it is set.</span>
<span class="sd">    </span>
<span class="sd">    `timeout` The max amount of time to wait for get (in seconds).  If this is reached a null is returned</span>
<span class="sd">    `returns` the set object.  This can technically be anything so know what your listening for.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span> <span class="o">-</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">setter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is used to complete this future. Whatever thread sets this will be used to call all </span>
<span class="sd">    listeners and callables for this future.</span>
<span class="sd">    </span>
<span class="sd">    `obj` The object you want to set on this future (usually use just True if you dont care)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">=</span> <span class="n">obj</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
      <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
          <span class="k">print</span> <span class="s">&quot;Exception calling listener&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span>
      <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">settable</span><span class="p">,</span> <span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
          <span class="k">print</span> <span class="s">&quot;Exception calling listener&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Already Set!&quot;</span><span class="p">)</span>
      

<span class="k">class</span> <span class="nc">Singleton</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A Simple inheritable singleton&quot;&quot;&quot;</span>

  <span class="n">__single</span> <span class="o">=</span> <span class="bp">None</span>

  <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cls</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__single</span><span class="p">):</span>
      <span class="n">cls</span><span class="o">.</span><span class="n">__single</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">__single</span>


<span class="k">class</span> <span class="nc">Clock</span><span class="p">(</span><span class="n">Singleton</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A Simple clock class to allow for retrieval of time from multiple threads to be more efficient.</span>
<span class="sd">  This class is a singleton so anyone using it will be using the same instance.</span>
<span class="sd">  The clock updates every 100ms so calls to get time often can be more per formant if they don&#39;t need to be exact.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__sleep</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__start_clock_thread</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__stop_clock_thread</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__update_clock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
      
  <span class="k">def</span> <span class="nf">accurate_time_millis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the actual current time. This should be called as little as often, and only </span>
<span class="sd">    when exact times are needed.</span>
<span class="sd">    </span>
<span class="sd">    `returns` an Integer of the current time in millis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">accurate_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the actual current time. This should be called as little as </span>
<span class="sd">    often, and only when exact times are needed.</span>
<span class="sd">    </span>
<span class="sd">    `returns` a float with whole numbers being seconds. Pretty much identical to time.time()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current</span>

  <span class="k">def</span> <span class="nf">last_known_time_millis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the last ran time in milliseconds. This is accurate to 100ms.</span>
<span class="sd">    </span>
<span class="sd">    `returns` an integer representing the last known time in millis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">last_known_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the last ran time seconds.milliseconds. This is accurate to 100ms.</span>
<span class="sd">    </span>
<span class="sd">    `returns` a float that represents the last known time with seconds as the whole numbers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current</span>

  <span class="k">def</span> <span class="nf">__start_clock_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__update_clock</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Clock Thread&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__stop_clock_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="threadly.futureJob">
    <p>def <span class="ident">futureJob</span>(</p><p>future, job)</p>
    </div>
    

    
  
    <div class="desc"><p>This is a simple helper function used to wrap a task on the Scheduler in a future.  Once
the job runs the future will complete. </p>
<p><code>future</code> The future that will be completed once the job finishes.
<code>job</code> The job to run before completing the future.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.futureJob', this);">Show source &equiv;</a></p>
  <div id="source-threadly.futureJob" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">futureJob</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">job</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is a simple helper function used to wrap a task on the Scheduler in a future.  Once</span>
<span class="sd">  the job runs the future will complete. </span>
<span class="sd">  </span>
<span class="sd">  `future` The future that will be completed once the job finishes.</span>
<span class="sd">  `job` The job to run before completing the future.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">job</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">job</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">job</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">future</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;Error running futureJob:&quot;</span><span class="p">,</span> <span class="n">e</span>
    <span class="n">future</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="threadly.Clock" class="name">class <span class="ident">Clock</span></p>
      
  
    <div class="desc"><p>A Simple clock class to allow for retrieval of time from multiple threads to be more efficient.
This class is a singleton so anyone using it will be using the same instance.
The clock updates every 100ms so calls to get time often can be more per formant if they don't need to be exact.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Clock', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Clock" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">Clock</span><span class="p">(</span><span class="n">Singleton</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A Simple clock class to allow for retrieval of time from multiple threads to be more efficient.</span>
<span class="sd">  This class is a singleton so anyone using it will be using the same instance.</span>
<span class="sd">  The clock updates every 100ms so calls to get time often can be more per formant if they don&#39;t need to be exact.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__sleep</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__start_clock_thread</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__stop_clock_thread</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__update_clock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
      
  <span class="k">def</span> <span class="nf">accurate_time_millis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the actual current time. This should be called as little as often, and only </span>
<span class="sd">    when exact times are needed.</span>
<span class="sd">    </span>
<span class="sd">    `returns` an Integer of the current time in millis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">accurate_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the actual current time. This should be called as little as </span>
<span class="sd">    often, and only when exact times are needed.</span>
<span class="sd">    </span>
<span class="sd">    `returns` a float with whole numbers being seconds. Pretty much identical to time.time()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current</span>

  <span class="k">def</span> <span class="nf">last_known_time_millis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the last ran time in milliseconds. This is accurate to 100ms.</span>
<span class="sd">    </span>
<span class="sd">    `returns` an integer representing the last known time in millis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">last_known_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the last ran time seconds.milliseconds. This is accurate to 100ms.</span>
<span class="sd">    </span>
<span class="sd">    `returns` a float that represents the last known time with seconds as the whole numbers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current</span>

  <span class="k">def</span> <span class="nf">__start_clock_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__update_clock</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Clock Thread&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__stop_clock_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#threadly.Clock">Clock</a></li>
          <li><a href="#threadly.Singleton">Singleton</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="threadly.Clock.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Clock.__init__', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Clock.__init__" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__thread</span> <span class="o">=</span> <span class="bp">None</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__sleep</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__start_clock_thread</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Clock.accurate_time">
    <p>def <span class="ident">accurate_time</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the actual current time. This should be called as little as 
often, and only when exact times are needed.</p>
<p><code>returns</code> a float with whole numbers being seconds. Pretty much identical to time.time()</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Clock.accurate_time', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Clock.accurate_time" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">accurate_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Get the actual current time. This should be called as little as </span>
<span class="sd">  often, and only when exact times are needed.</span>
<span class="sd">  </span>
<span class="sd">  `returns` a float with whole numbers being seconds. Pretty much identical to time.time()</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span><span class="p">()</span>
  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Clock.accurate_time_millis">
    <p>def <span class="ident">accurate_time_millis</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the actual current time. This should be called as little as often, and only 
when exact times are needed.</p>
<p><code>returns</code> an Integer of the current time in millis.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Clock.accurate_time_millis', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Clock.accurate_time_millis" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">accurate_time_millis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Get the actual current time. This should be called as little as often, and only </span>
<span class="sd">  when exact times are needed.</span>
<span class="sd">  </span>
<span class="sd">  `returns` an Integer of the current time in millis.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_time</span><span class="p">()</span>
  <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Clock.last_known_time">
    <p>def <span class="ident">last_known_time</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Gets the last ran time seconds.milliseconds. This is accurate to 100ms.</p>
<p><code>returns</code> a float that represents the last known time with seconds as the whole numbers.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Clock.last_known_time', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Clock.last_known_time" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">last_known_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Gets the last ran time seconds.milliseconds. This is accurate to 100ms.</span>
<span class="sd">  </span>
<span class="sd">  `returns` a float that represents the last known time with seconds as the whole numbers.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Clock.last_known_time_millis">
    <p>def <span class="ident">last_known_time_millis</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Gets the last ran time in milliseconds. This is accurate to 100ms.</p>
<p><code>returns</code> an integer representing the last known time in millis.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Clock.last_known_time_millis', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Clock.last_known_time_millis" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">last_known_time_millis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Gets the last ran time in milliseconds. This is accurate to 100ms.</span>
<span class="sd">  </span>
<span class="sd">  `returns` an integer representing the last known time in millis.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="threadly.Executor" class="name">class <span class="ident">Executor</span></p>
      
  
    <div class="desc"><p>A class for backwards compatibility, Scheduler should be used instead now.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">Executor</span><span class="p">(</span><span class="n">Scheduler</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A class for backwards compatibility, Scheduler should be used instead now.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">pass</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#threadly.Executor">Executor</a></li>
          <li><a href="#threadly.Scheduler">Scheduler</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="threadly.Executor.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, poolsize)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Construct an Scheduler instance with the set thread pool size.</p>
<p><code>poolsize</code> positive integer for the number of threads you want in this pool .</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.__init__', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.__init__" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poolsize</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Construct an Scheduler instance with the set thread pool size.</span>
<span class="sd">  </span>
<span class="sd">  `poolsize` positive integer for the number of threads you want in this pool .</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;root.threadly&quot;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__clock</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__in_shutdown</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span> <span class="o">=</span> <span class="n">SortedLockingList</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__in_delay</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delay_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span><span class="p">):</span>
    <span class="n">tmp_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__thread_pool</span><span class="p">)</span>
    <span class="n">tmp_thread</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Executor-Pool-Thread-</span><span class="si">%d</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">tmp_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">tmp_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_thread</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.execute">
    <p>def <span class="ident">execute</span>(</p><p>self, task, args=(), kwargs={})</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.execute">execute</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Execute a given task as soon as possible.</p>
<p><code>task</code> is a callable to be called on the Scheduler.</p>
<p><code>args</code> are the arguments to pass to the callable when called.</p>
<p><code>kwargs</code> are the keyword args to be passed to the callable when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.execute', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.execute" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Execute a given task as soon as possible.</span>
<span class="sd">  </span>
<span class="sd">  `task` is a callable to be called on the Scheduler.</span>
<span class="sd">  `args` are the arguments to pass to the callable when called.</span>
<span class="sd">  `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.get_poolsize">
    <p>def <span class="ident">get_poolsize</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.get_poolsize">get_poolsize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns the number of threads used in this Pool.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.get_poolsize', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.get_poolsize" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">get_poolsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns the number of threads used in this Pool.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.get_queue_size">
    <p>def <span class="ident">get_queue_size</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.get_queue_size">get_queue_size</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns the number of items currently awaiting Execution.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.get_queue_size', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.get_queue_size" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">get_queue_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns the number of items currently awaiting Execution.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.remove">
    <p>def <span class="ident">remove</span>(</p><p>self, task)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.remove">remove</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Remove a scheduled task from the queue.  This is a best effort remove, the task could still possibly run.  This is most useful to cancel recurring tasks.
If there is more then one task with this callable scheduled only the first one is removed.</p>
<p><code>task</code> callable task to remove from the scheduled tasks list.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.remove', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.remove" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Remove a scheduled task from the queue.  This is a best effort remove, the task could still possibly run.  This is most useful to cancel recurring tasks.</span>
<span class="sd">  If there is more then one task with this callable scheduled only the first one is removed.</span>
<span class="sd">  `task` callable task to remove from the scheduled tasks list.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="k">for</span> <span class="n">tasks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">safeIterator</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">task</span><span class="p">:</span>
      <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
  <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>
  <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.schedule">
    <p>def <span class="ident">schedule</span>(</p><p>self, task, delay=0, recurring=False, key=None, args=(), kwargs={})</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.schedule">schedule</a></code>
    </p>

    
  
    <div class="desc inherited"><p>This schedules a task to be executed.  It can be delayed, and set to a key.  It can also be marked
as recurring. </p>
<p><code>task</code> is a callable to be called on the Scheduler.</p>
<p><code>delay</code> this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</p>
<p><code>recurring</code> set this to True if this should be a recurring.  You should be careful that delay is &gt; 0 when setting this to True</p>
<p><code>key</code> this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</p>
<p><code>args</code> are the arguments to pass to the callable when called.</p>
<p><code>kwargs</code> are the keyword args to be passed to the callable when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.schedule', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.schedule" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This schedules a task to be executed.  It can be delayed, and set to a key.  It can also be marked</span>
<span class="sd">  as recurring. </span>
<span class="sd">  </span>
<span class="sd">  `task` is a callable to be called on the Scheduler.</span>
<span class="sd">  `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>
<span class="sd">  `recurring` set this to True if this should be a recurring.  You should be careful that delay is &gt; 0 when setting this to True</span>
<span class="sd">  `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>
<span class="sd">  `args` are the arguments to pass to the callable when called.</span>
<span class="sd">  `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">s_task</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__clock</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="n">delay</span>
    <span class="n">send</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">delay</span><span class="o">/</span><span class="mf">1000.0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">():</span>
      <span class="n">send</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">s_task</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">recurring</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">send</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__empty</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">KeyRunner</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
      <span class="n">run_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
      <span class="n">run_key</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
      <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="ow">and</span> <span class="n">run_key</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">run_key</span><span class="o">.</span><span class="n">run_all</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
      <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.schedule_with_future">
    <p>def <span class="ident">schedule_with_future</span>(</p><p>self, task, delay=0, key=None, args=(), kwargs={})</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.schedule_with_future">schedule_with_future</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a <code>ListenableFuture</code> for this task.  Once the task is completed the future will also be completed. 
This works pretty much exactly like <code>schedule</code> except you can not make a task recurring.</p>
<p><code>task</code> is a callable to be called on the Scheduler.</p>
<p><code>delay</code> this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</p>
<p><code>key</code> this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</p>
<p><code>args</code> are the arguments to pass to the callable when called.</p>
<p><code>kwargs</code> are the keyword args to be passed to the callable when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.schedule_with_future', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.schedule_with_future" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">schedule_with_future</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns a `ListenableFuture` for this task.  Once the task is completed the future will also be completed. </span>
<span class="sd">  This works pretty much exactly like `schedule` except you can not make a task recurring.</span>
<span class="sd">  </span>
<span class="sd">  `task` is a callable to be called on the Scheduler.</span>
<span class="sd">  `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>
<span class="sd">  `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>
<span class="sd">  `args` are the arguments to pass to the callable when called.</span>
<span class="sd">  `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">job</span><span class="o">=</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
  <span class="n">future</span> <span class="o">=</span> <span class="n">ListenableFuture</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">futureJob</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">job</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">future</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.shutdown">
    <p>def <span class="ident">shutdown</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.shutdown">shutdown</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Shuts down the threadpool.  Any task currently on the queue will be ran, but all Scheduled tasks 
will removed and no more tasks can be added.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.shutdown', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.shutdown" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Shuts down the threadpool.  Any task currently on the queue will be ran, but all Scheduled tasks </span>
<span class="sd">  will removed and no more tasks can be added.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Executor.shutdown_now">
    <p>def <span class="ident">shutdown_now</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#threadly.Scheduler">Scheduler</a></code>.<code><a href="#threadly.Scheduler.shutdown_now">shutdown_now</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Shuts down the threadpool.  Any task currently being executed will still complete, 
but the queue will be emptied out.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Executor.shutdown_now', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Executor.shutdown_now" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">shutdown_now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Shuts down the threadpool.  Any task currently being executed will still complete, </span>
<span class="sd">  but the queue will be emptied out.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
  <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="threadly.KeyRunner" class="name">class <span class="ident">KeyRunner</span></p>
      
  
    <div class="desc"><p>A class to wrap keys objects for the executer.
Items can be added to the KeyRunner while its running.<br />
This is used to keep all tasks for a given key in one thread.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.KeyRunner', this);">Show source &equiv;</a></p>
  <div id="source-threadly.KeyRunner" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">KeyRunner</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A class to wrap keys objects for the executer.</span>
<span class="sd">  Items can be added to the KeyRunner while its running.  </span>
<span class="sd">  This is used to keep all tasks for a given key in one thread.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">False</span>

  <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a task to this runner set.</span>

<span class="sd">    `task` adds callable task to the current keyrunner set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">run_next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the next item for this key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="n">runner</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">runner</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">runner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

  <span class="k">def</span> <span class="nf">run_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run all items in this keyRunner.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">run_next</span><span class="p">()</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">False</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
          <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#threadly.KeyRunner">KeyRunner</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="threadly.KeyRunner.in_queue" class="name">var <span class="ident">in_queue</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="threadly.KeyRunner.lock" class="name">var <span class="ident">lock</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="threadly.KeyRunner.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.KeyRunner.__init__', this);">Show source &equiv;</a></p>
  <div id="source-threadly.KeyRunner.__init__" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__run</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.KeyRunner.add">
    <p>def <span class="ident">add</span>(</p><p>self, task)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a task to this runner set.</p>
<p><code>task</code> adds callable task to the current keyrunner set.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.KeyRunner.add', this);">Show source &equiv;</a></p>
  <div id="source-threadly.KeyRunner.add" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Add a task to this runner set.</span>
<span class="sd">  `task` adds callable task to the current keyrunner set.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.KeyRunner.run_all">
    <p>def <span class="ident">run_all</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Run all items in this keyRunner.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.KeyRunner.run_all', this);">Show source &equiv;</a></p>
  <div id="source-threadly.KeyRunner.run_all" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">run_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Run all items in this keyRunner.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_next</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">break</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.KeyRunner.run_next">
    <p>def <span class="ident">run_next</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Run the next item for this key.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.KeyRunner.run_next', this);">Show source &equiv;</a></p>
  <div id="source-threadly.KeyRunner.run_next" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">run_next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Run the next item for this key.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
  <span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
  <span class="n">runner</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">runner</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">runner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.KeyRunner.size">
    <p>def <span class="ident">size</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.KeyRunner.size', this);">Show source &equiv;</a></p>
  <div id="source-threadly.KeyRunner.size" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="threadly.ListenableFuture" class="name">class <span class="ident">ListenableFuture</span></p>
      
  
    <div class="desc"><p>This class i used to make a Future that can have listeners and callbacks added to it.
Once setter(object) is called all listeners/callbacks are also called.  Callbacks will 
be given the set object, and .get() will return said object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.ListenableFuture', this);">Show source &equiv;</a></p>
  <div id="source-threadly.ListenableFuture" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">ListenableFuture</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This class i used to make a Future that can have listeners and callbacks added to it.</span>
<span class="sd">  Once setter(object) is called all listeners/callbacks are also called.  Callbacks will </span>
<span class="sd">  be given the set object, and .get() will return said object.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  
  <span class="k">def</span> <span class="nf">addListener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listener</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a listener function to this ListenableFuture.  Once set is called on this future</span>
<span class="sd">    all listeners will be ran.  Arguments for the listener can be given if needed.</span>
<span class="sd">    </span>
<span class="sd">    `listener` a callable that will be called when the future is completed</span>
<span class="sd">    `args` tuple arguments that will be passed to the listener when called.</span>
<span class="sd">    `kwargs` dict keyword arguments to be passed to the passed listener when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">listener</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">listener</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">addCallable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cable</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a callable function to this ListenableFuture.  Once set is called on this future</span>
<span class="sd">    all callables will be ran.  This works the same as the listener except the set object is passed </span>
<span class="sd">    as the first argument when the callable is called. Arguments for the listener can be given if needed.</span>
<span class="sd">    </span>
<span class="sd">    `cable` a callable that will be called when the future is completed, it must have at least 1 argument.</span>
<span class="sd">    `args` tuple arguments that will be passed to the listener when called.</span>
<span class="sd">    `kwargs` dict keyword arguments to be passed to the passed listener when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cable</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">cable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a blocking call that will return the set object once it is set.</span>
<span class="sd">    </span>
<span class="sd">    `timeout` The max amount of time to wait for get (in seconds).  If this is reached a null is returned</span>
<span class="sd">    `returns` the set object.  This can technically be anything so know what your listening for.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span> <span class="o">-</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">setter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is used to complete this future. Whatever thread sets this will be used to call all </span>
<span class="sd">    listeners and callables for this future.</span>
<span class="sd">    </span>
<span class="sd">    `obj` The object you want to set on this future (usually use just True if you dont care)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">=</span> <span class="n">obj</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
      <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
          <span class="k">print</span> <span class="s">&quot;Exception calling listener&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span>
      <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">settable</span><span class="p">,</span> <span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
          <span class="k">print</span> <span class="s">&quot;Exception calling listener&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Already Set!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#threadly.ListenableFuture">ListenableFuture</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="threadly.ListenableFuture.callables" class="name">var <span class="ident">callables</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="threadly.ListenableFuture.listeners" class="name">var <span class="ident">listeners</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="threadly.ListenableFuture.lock" class="name">var <span class="ident">lock</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="threadly.ListenableFuture.settable" class="name">var <span class="ident">settable</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="threadly.ListenableFuture.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.ListenableFuture.__init__', this);">Show source &equiv;</a></p>
  <div id="source-threadly.ListenableFuture.__init__" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">=</span> <span class="bp">None</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">callables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.ListenableFuture.addCallable">
    <p>def <span class="ident">addCallable</span>(</p><p>self, cable, args=(), kwargs={})</p>
    </div>
    

    
  
    <div class="desc"><p>Add a callable function to this ListenableFuture.  Once set is called on this future
all callables will be ran.  This works the same as the listener except the set object is passed 
as the first argument when the callable is called. Arguments for the listener can be given if needed.</p>
<p><code>cable</code> a callable that will be called when the future is completed, it must have at least 1 argument.
<code>args</code> tuple arguments that will be passed to the listener when called.
<code>kwargs</code> dict keyword arguments to be passed to the passed listener when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.ListenableFuture.addCallable', this);">Show source &equiv;</a></p>
  <div id="source-threadly.ListenableFuture.addCallable" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">addCallable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cable</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Add a callable function to this ListenableFuture.  Once set is called on this future</span>
<span class="sd">  all callables will be ran.  This works the same as the listener except the set object is passed </span>
<span class="sd">  as the first argument when the callable is called. Arguments for the listener can be given if needed.</span>
<span class="sd">  </span>
<span class="sd">  `cable` a callable that will be called when the future is completed, it must have at least 1 argument.</span>
<span class="sd">  `args` tuple arguments that will be passed to the listener when called.</span>
<span class="sd">  `kwargs` dict keyword arguments to be passed to the passed listener when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cable</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">cable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.ListenableFuture.addListener">
    <p>def <span class="ident">addListener</span>(</p><p>self, listener, args=(), kwargs={})</p>
    </div>
    

    
  
    <div class="desc"><p>Add a listener function to this ListenableFuture.  Once set is called on this future
all listeners will be ran.  Arguments for the listener can be given if needed.</p>
<p><code>listener</code> a callable that will be called when the future is completed
<code>args</code> tuple arguments that will be passed to the listener when called.
<code>kwargs</code> dict keyword arguments to be passed to the passed listener when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.ListenableFuture.addListener', this);">Show source &equiv;</a></p>
  <div id="source-threadly.ListenableFuture.addListener" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">addListener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listener</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Add a listener function to this ListenableFuture.  Once set is called on this future</span>
<span class="sd">  all listeners will be ran.  Arguments for the listener can be given if needed.</span>
<span class="sd">  </span>
<span class="sd">  `listener` a callable that will be called when the future is completed</span>
<span class="sd">  `args` tuple arguments that will be passed to the listener when called.</span>
<span class="sd">  `kwargs` dict keyword arguments to be passed to the passed listener when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">listener</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">listener</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.ListenableFuture.get">
    <p>def <span class="ident">get</span>(</p><p>self, timeout=4294967296)</p>
    </div>
    

    
  
    <div class="desc"><p>This is a blocking call that will return the set object once it is set.</p>
<p><code>timeout</code> The max amount of time to wait for get (in seconds).  If this is reached a null is returned
<code>returns</code> the set object.  This can technically be anything so know what your listening for.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.ListenableFuture.get', this);">Show source &equiv;</a></p>
  <div id="source-threadly.ListenableFuture.get" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is a blocking call that will return the set object once it is set.</span>
<span class="sd">  </span>
<span class="sd">  `timeout` The max amount of time to wait for get (in seconds).  If this is reached a null is returned</span>
<span class="sd">  `returns` the set object.  This can technically be anything so know what your listening for.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span>
  <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span> <span class="o">-</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span>
  <span class="k">finally</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.ListenableFuture.setter">
    <p>def <span class="ident">setter</span>(</p><p>self, obj)</p>
    </div>
    

    
  
    <div class="desc"><p>This is used to complete this future. Whatever thread sets this will be used to call all 
listeners and callables for this future.</p>
<p><code>obj</code> The object you want to set on this future (usually use just True if you dont care)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.ListenableFuture.setter', this);">Show source &equiv;</a></p>
  <div id="source-threadly.ListenableFuture.setter" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">setter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is used to complete this future. Whatever thread sets this will be used to call all </span>
<span class="sd">  listeners and callables for this future.</span>
<span class="sd">  </span>
<span class="sd">  `obj` The object you want to set on this future (usually use just True if you dont care)</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settable</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listeners</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Exception calling listener&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">settable</span><span class="p">,</span> <span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Exception calling listener&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Already Set!&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="threadly.Scheduler" class="name">class <span class="ident">Scheduler</span></p>
      
  
    <div class="desc"><p>Main Scheduler Object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">Scheduler</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Main Scheduler Object.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poolsize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct an Scheduler instance with the set thread pool size.</span>
<span class="sd">    </span>
<span class="sd">    `poolsize` positive integer for the number of threads you want in this pool .</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;root.threadly&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__clock</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__in_shutdown</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span> <span class="o">=</span> <span class="n">SortedLockingList</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__in_delay</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delay_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span><span class="p">):</span>
      <span class="n">tmp_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__thread_pool</span><span class="p">)</span>
      <span class="n">tmp_thread</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Executor-Pool-Thread-</span><span class="si">%d</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">tmp_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="n">tmp_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_thread</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_poolsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of threads used in this Pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_queue_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of items currently awaiting Execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute a given task as soon as possible.</span>
<span class="sd">    </span>
<span class="sd">    `task` is a callable to be called on the Scheduler.</span>

<span class="sd">    `args` are the arguments to pass to the callable when called.</span>

<span class="sd">    `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">schedule_with_future</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a `ListenableFuture` for this task.  Once the task is completed the future will also be completed. </span>
<span class="sd">    This works pretty much exactly like `schedule` except you can not make a task recurring.</span>
<span class="sd">    </span>
<span class="sd">    `task` is a callable to be called on the Scheduler.</span>

<span class="sd">    `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>

<span class="sd">    `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>

<span class="sd">    `args` are the arguments to pass to the callable when called.</span>

<span class="sd">    `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job</span><span class="o">=</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
    <span class="n">future</span> <span class="o">=</span> <span class="n">ListenableFuture</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">futureJob</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">job</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">future</span>

  <span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This schedules a task to be executed.  It can be delayed, and set to a key.  It can also be marked</span>
<span class="sd">    as recurring. </span>
<span class="sd">    </span>
<span class="sd">    `task` is a callable to be called on the Scheduler.</span>

<span class="sd">    `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>

<span class="sd">    `recurring` set this to True if this should be a recurring.  You should be careful that delay is &gt; 0 when setting this to True</span>

<span class="sd">    `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>

<span class="sd">    `args` are the arguments to pass to the callable when called.</span>

<span class="sd">    `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">s_task</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__clock</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="n">delay</span>
      <span class="n">send</span> <span class="o">=</span> <span class="bp">False</span>
      <span class="k">if</span> <span class="n">delay</span><span class="o">/</span><span class="mf">1000.0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">():</span>
        <span class="n">send</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">s_task</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">recurring</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">send</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__empty</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">:</span>
          <span class="n">tmp</span> <span class="o">=</span> <span class="n">KeyRunner</span><span class="p">()</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="n">run_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="ow">and</span> <span class="n">run_key</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

          <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">True</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">run_key</span><span class="o">.</span><span class="n">run_all</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove a scheduled task from the queue.  This is a best effort remove, the task could still possibly run.  This is most useful to cancel recurring tasks.</span>
<span class="sd">    If there is more then one task with this callable scheduled only the first one is removed.</span>

<span class="sd">    `task` callable task to remove from the scheduled tasks list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">tasks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">safeIterator</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">task</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">break</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
      <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shuts down the threadpool.  Any task currently on the queue will be ran, but all Scheduled tasks </span>
<span class="sd">    will removed and no more tasks can be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">shutdown_now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shuts down the threadpool.  Any task currently being executed will still complete, </span>
<span class="sd">    but the queue will be emptied out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__internal_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">tmp_thread</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="p">:</span>
      <span class="k">while</span> <span class="n">tmp_thread</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">tmp_thread</span><span class="o">.</span><span class="n">isAlive</span><span class="p">()</span> <span class="ow">and</span> <span class="n">threading</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">tmp_thread</span> <span class="o">!=</span> <span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__empty</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>

  <span class="k">def</span> <span class="nf">__empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">pass</span>

  <span class="k">def</span> <span class="nf">__get_next_wait_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">tmp</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">task</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__clock</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">task</span><span class="o">/</span><span class="mf">1000.0</span><span class="p">)</span><span class="o">-.</span><span class="mo">0005</span>

  <span class="k">def</span> <span class="nf">__check_delay_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">dl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">dl</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">to</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">run_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">run_task</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="n">run_task</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="n">run_task</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">run_task</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
          <span class="c">#run_task[3] is recurring, if so we add again as a scheduled event</span>
          <span class="k">if</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__in_shutdown</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">run_task</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">run_task</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
          <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
      <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">dl</span>


  <span class="k">def</span> <span class="nf">__thread_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">__running</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">runner</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">to</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_delay_queue</span><span class="p">():</span>
          <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">to</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">to</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">runner</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">to</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">runner</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">runner</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">runner</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">runner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">exp</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">except</span> <span class="n">EmptyException</span> <span class="k">as</span> <span class="n">exp</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exp</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Exception while Executing: </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">exp</span><span class="p">))</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#threadly.Scheduler">Scheduler</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, poolsize)</p>
    </div>
    

    
  
    <div class="desc"><p>Construct an Scheduler instance with the set thread pool size.</p>
<p><code>poolsize</code> positive integer for the number of threads you want in this pool .</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.__init__', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.__init__" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poolsize</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Construct an Scheduler instance with the set thread pool size.</span>
<span class="sd">  </span>
<span class="sd">  `poolsize` positive integer for the number of threads you want in this pool .</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;root.threadly&quot;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__clock</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__in_shutdown</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span> <span class="o">=</span> <span class="n">SortedLockingList</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__in_delay</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delay_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__poolsize</span><span class="p">):</span>
    <span class="n">tmp_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__thread_pool</span><span class="p">)</span>
    <span class="n">tmp_thread</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Executor-Pool-Thread-</span><span class="si">%d</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">tmp_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">tmp_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_thread</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.execute">
    <p>def <span class="ident">execute</span>(</p><p>self, task, args=(), kwargs={})</p>
    </div>
    

    
  
    <div class="desc"><p>Execute a given task as soon as possible.</p>
<p><code>task</code> is a callable to be called on the Scheduler.</p>
<p><code>args</code> are the arguments to pass to the callable when called.</p>
<p><code>kwargs</code> are the keyword args to be passed to the callable when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.execute', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.execute" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Execute a given task as soon as possible.</span>
<span class="sd">  </span>
<span class="sd">  `task` is a callable to be called on the Scheduler.</span>
<span class="sd">  `args` are the arguments to pass to the callable when called.</span>
<span class="sd">  `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.get_poolsize">
    <p>def <span class="ident">get_poolsize</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the number of threads used in this Pool.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.get_poolsize', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.get_poolsize" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">get_poolsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns the number of threads used in this Pool.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__threads</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.get_queue_size">
    <p>def <span class="ident">get_queue_size</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the number of items currently awaiting Execution.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.get_queue_size', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.get_queue_size" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">get_queue_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns the number of items currently awaiting Execution.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.remove">
    <p>def <span class="ident">remove</span>(</p><p>self, task)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove a scheduled task from the queue.  This is a best effort remove, the task could still possibly run.  This is most useful to cancel recurring tasks.
If there is more then one task with this callable scheduled only the first one is removed.</p>
<p><code>task</code> callable task to remove from the scheduled tasks list.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.remove', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.remove" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Remove a scheduled task from the queue.  This is a best effort remove, the task could still possibly run.  This is most useful to cancel recurring tasks.</span>
<span class="sd">  If there is more then one task with this callable scheduled only the first one is removed.</span>
<span class="sd">  `task` callable task to remove from the scheduled tasks list.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="k">for</span> <span class="n">tasks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">safeIterator</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">task</span><span class="p">:</span>
      <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
      <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
  <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>
  <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.schedule">
    <p>def <span class="ident">schedule</span>(</p><p>self, task, delay=0, recurring=False, key=None, args=(), kwargs={})</p>
    </div>
    

    
  
    <div class="desc"><p>This schedules a task to be executed.  It can be delayed, and set to a key.  It can also be marked
as recurring. </p>
<p><code>task</code> is a callable to be called on the Scheduler.</p>
<p><code>delay</code> this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</p>
<p><code>recurring</code> set this to True if this should be a recurring.  You should be careful that delay is &gt; 0 when setting this to True</p>
<p><code>key</code> this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</p>
<p><code>args</code> are the arguments to pass to the callable when called.</p>
<p><code>kwargs</code> are the keyword args to be passed to the callable when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.schedule', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.schedule" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This schedules a task to be executed.  It can be delayed, and set to a key.  It can also be marked</span>
<span class="sd">  as recurring. </span>
<span class="sd">  </span>
<span class="sd">  `task` is a callable to be called on the Scheduler.</span>
<span class="sd">  `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>
<span class="sd">  `recurring` set this to True if this should be a recurring.  You should be careful that delay is &gt; 0 when setting this to True</span>
<span class="sd">  `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>
<span class="sd">  `args` are the arguments to pass to the callable when called.</span>
<span class="sd">  `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">s_task</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__clock</span><span class="o">.</span><span class="n">accurate_time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="n">delay</span>
    <span class="n">send</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">delay</span><span class="o">/</span><span class="mf">1000.0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_next_wait_time</span><span class="p">():</span>
      <span class="n">send</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">s_task</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">recurring</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">send</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__empty</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">KeyRunner</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__key_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
      <span class="n">run_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
      <span class="n">run_key</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
      <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="ow">and</span> <span class="n">run_key</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">run_key</span><span class="o">.</span><span class="n">in_queue</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">run_key</span><span class="o">.</span><span class="n">run_all</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{}))</span>
      <span class="n">run_key</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.schedule_with_future">
    <p>def <span class="ident">schedule_with_future</span>(</p><p>self, task, delay=0, key=None, args=(), kwargs={})</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a <code>ListenableFuture</code> for this task.  Once the task is completed the future will also be completed. 
This works pretty much exactly like <code>schedule</code> except you can not make a task recurring.</p>
<p><code>task</code> is a callable to be called on the Scheduler.</p>
<p><code>delay</code> this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</p>
<p><code>key</code> this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</p>
<p><code>args</code> are the arguments to pass to the callable when called.</p>
<p><code>kwargs</code> are the keyword args to be passed to the callable when called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.schedule_with_future', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.schedule_with_future" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">schedule_with_future</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{}):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns a `ListenableFuture` for this task.  Once the task is completed the future will also be completed. </span>
<span class="sd">  This works pretty much exactly like `schedule` except you can not make a task recurring.</span>
<span class="sd">  </span>
<span class="sd">  `task` is a callable to be called on the Scheduler.</span>
<span class="sd">  `delay` this is the time to wait (in milliseconds!!) before scheduler will call the passed task.</span>
<span class="sd">  `key` this is any python object to use as a key.  All tasks using this key will be ran in a single threaded manor.</span>
<span class="sd">  `args` are the arguments to pass to the callable when called.</span>
<span class="sd">  `kwargs` are the keyword args to be passed to the callable when called.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">job</span><span class="o">=</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
  <span class="n">future</span> <span class="o">=</span> <span class="n">ListenableFuture</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">futureJob</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">job</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">future</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.shutdown">
    <p>def <span class="ident">shutdown</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Shuts down the threadpool.  Any task currently on the queue will be ran, but all Scheduled tasks 
will removed and no more tasks can be added.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.shutdown', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.shutdown" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Shuts down the threadpool.  Any task currently on the queue will be ran, but all Scheduled tasks </span>
<span class="sd">  will removed and no more tasks can be added.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.Scheduler.shutdown_now">
    <p>def <span class="ident">shutdown_now</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Shuts down the threadpool.  Any task currently being executed will still complete, 
but the queue will be emptied out.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Scheduler.shutdown_now', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Scheduler.shutdown_now" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">shutdown_now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Shuts down the threadpool.  Any task currently being executed will still complete, </span>
<span class="sd">  but the queue will be emptied out.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__running</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__delayed_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
  <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__main_queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__internal_shutdown</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="threadly.Singleton" class="name">class <span class="ident">Singleton</span></p>
      
  
    <div class="desc"><p>A Simple inheritable singleton</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.Singleton', this);">Show source &equiv;</a></p>
  <div id="source-threadly.Singleton" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">Singleton</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A Simple inheritable singleton&quot;&quot;&quot;</span>

  <span class="n">__single</span> <span class="o">=</span> <span class="bp">None</span>

  <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cls</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__single</span><span class="p">):</span>
      <span class="n">cls</span><span class="o">.</span><span class="n">__single</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">__single</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#threadly.Singleton">Singleton</a></li>
          <li>__builtin__.object</li>
          </ul>
      </div>
      </div>
      
      <div class="item">
      <p id="threadly.SortedLockingList" class="name">class <span class="ident">SortedLockingList</span></p>
      
  
    <div class="desc"><p>This is a sortedList implementation for multiThreads.  One main goal is to make adds as cheap as possible.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">SortedLockingList</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is a sortedList implementation for multiThreads.  One main goal is to make adds as cheap as possible.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    clears out the list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns `True` if you get the lock `False` if you dont.</span>

<span class="sd">    Non-Blocking lock request, returns True if you get the lock false if you dont.  This is the main</span>
<span class="sd">    lock for the list once acquired you must release before any other thread can access the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">unlock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Releases the lists lock.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns and `int` of the current size of the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the first entry in the list, this does not remove the entry from the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">tmp</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tmp</span>

  <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns either the first entry from the list or the spesified entry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tmp</span>
  
  <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an entry to the list.</span>

<span class="sd">    `item` entry to add to the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">__combine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span>
          <span class="n">lmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
          <span class="n">ch</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="mi">2</span>
          <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">[</span><span class="n">ch</span><span class="p">]:</span>
              <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;ERROR:&quot;</span>
                <span class="k">return</span>
              <span class="k">else</span><span class="p">:</span>
                <span class="n">lmax</span> <span class="o">=</span> <span class="n">ch</span><span class="o">-</span><span class="mi">1</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">ch</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="n">l</span><span class="p">[</span><span class="n">ch</span><span class="p">]:</span>
              <span class="k">if</span> <span class="n">ch</span> <span class="o">&gt;=</span> <span class="n">lmax</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">break</span>
              <span class="k">else</span><span class="p">:</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">lmax</span><span class="o">-</span><span class="n">ch</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">ch</span><span class="o">+</span><span class="p">((</span><span class="n">diff</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">l</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
              <span class="k">break</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes an item from the list.</span>
<span class="sd">  </span>
<span class="sd">    `item` item to remove from the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="k">pass</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">safeIterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a non-Blocking safe iterator for the list.  It is essentially just a copy of the sorted lists</span>
<span class="sd">    entries at the time it was called. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="n">local</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">local</span><span class="p">:</span>
      <span class="k">yield</span> <span class="n">i</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#threadly.SortedLockingList">SortedLockingList</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="threadly.SortedLockingList.slist" class="name">var <span class="ident">slist</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="threadly.SortedLockingList.uslist" class="name">var <span class="ident">uslist</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.__init__', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.__init__" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">slist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.add">
    <p>def <span class="ident">add</span>(</p><p>self, item)</p>
    </div>
    

    
  
    <div class="desc"><p>Adds an entry to the list.</p>
<p><code>item</code> entry to add to the list.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.add', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.add" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Adds an entry to the list.</span>
<span class="sd">  `item` entry to add to the list.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.clear">
    <p>def <span class="ident">clear</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>clears out the list</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.clear', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.clear" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  clears out the list</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">slist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">uslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.lock">
    <p>def <span class="ident">lock</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns <code>True</code> if you get the lock <code>False</code> if you dont.</p>
<p>Non-Blocking lock request, returns True if you get the lock false if you dont.  This is the main
lock for the list once acquired you must release before any other thread can access the list.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.lock', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.lock" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns `True` if you get the lock `False` if you dont.</span>
<span class="sd">  Non-Blocking lock request, returns True if you get the lock false if you dont.  This is the main</span>
<span class="sd">  lock for the list once acquired you must release before any other thread can access the list.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.peek">
    <p>def <span class="ident">peek</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the first entry in the list, this does not remove the entry from the list.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.peek', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.peek" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns the first entry in the list, this does not remove the entry from the list.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="bp">None</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">tmp</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.pop">
    <p>def <span class="ident">pop</span>(</p><p>self, i=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns either the first entry from the list or the spesified entry.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.pop', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.pop" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns either the first entry from the list or the spesified entry.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
  <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">tmp</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.remove">
    <p>def <span class="ident">remove</span>(</p><p>self, item)</p>
    </div>
    

    
  
    <div class="desc"><p>Removes an item from the list.</p>
<p><code>item</code> item to remove from the list.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.remove', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.remove" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Removes an item from the list.</span>

<span class="sd">  `item` item to remove from the list.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
  <span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
  <span class="k">finally</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.safeIterator">
    <p>def <span class="ident">safeIterator</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>This is a non-Blocking safe iterator for the list.  It is essentially just a copy of the sorted lists
entries at the time it was called.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.safeIterator', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.safeIterator" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">safeIterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is a non-Blocking safe iterator for the list.  It is essentially just a copy of the sorted lists</span>
<span class="sd">  entries at the time it was called. </span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__combine</span><span class="p">()</span>
  <span class="k">finally</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
  <span class="n">local</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">local</span><span class="p">:</span>
    <span class="k">yield</span> <span class="n">i</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.size">
    <p>def <span class="ident">size</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns and <code>int</code> of the current size of the list.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.size', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.size" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Returns and `int` of the current size of the list.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slist</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uslist</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="threadly.SortedLockingList.unlock">
    <p>def <span class="ident">unlock</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Releases the lists lock.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-threadly.SortedLockingList.unlock', this);">Show source &equiv;</a></p>
  <div id="source-threadly.SortedLockingList.unlock" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">unlock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Releases the lists lock.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">__lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.1</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
